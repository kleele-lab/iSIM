
The following have been reloaded with a version change:
  1) cudnn/8.8.1.3 => cudnn/8.9.2.26

Reading folder: /nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h
/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_10/240119_RPE1_Torin_Mdivi1_18h_10_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:15<00:15, 15.07s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.08s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_11/240119_RPE1_Torin_Mdivi1_18h_11_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:15<00:15, 15.34s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:25<00:25, 25.23s/it]
  0%|          | 0/1 [00:25<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_12/240119_RPE1_Torin_Mdivi1_18h_12_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:15<00:15, 15.19s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.10s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_13/240119_RPE1_Torin_Mdivi1_18h_13_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.98s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.88s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_14/240119_RPE1_Torin_Mdivi1_18h_14_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.99s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:23<00:23, 23.91s/it]
  0%|          | 0/1 [00:23<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_15/240119_RPE1_Torin_Mdivi1_18h_15_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.99s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.78s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_16/240119_RPE1_Torin_Mdivi1_18h_16_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.77s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:23<00:23, 23.55s/it]
  0%|          | 0/1 [00:23<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_18/240119_RPE1_Torin_Mdivi1_18h_18_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.81s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.55s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_19/240119_RPE1_Torin_Mdivi1_18h_19_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.76s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:23<00:23, 23.63s/it]
  0%|          | 0/1 [00:23<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_2/240119_RPE1_Torin_Mdivi1_18h_2_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 26, 1, 1532, 2140)
85145034
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:17<00:00, 17.63s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:17<00:00, 17.63s/it]
DECON SHAPE  (1, 26, 1, 1532, 2140)
/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_20/240119_RPE1_Torin_Mdivi1_18h_20_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.96s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:23<00:23, 23.90s/it]
  0%|          | 0/1 [00:23<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_21/240119_RPE1_Torin_Mdivi1_18h_21_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.97s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.60s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_3/240119_RPE1_Torin_Mdivi1_18h_3_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 26, 1, 1532, 2140)
85145034
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:17<00:00, 17.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:17<00:00, 17.68s/it]
DECON SHAPE  (1, 26, 1, 1532, 2140)
/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_5/240119_RPE1_Torin_Mdivi1_18h_5_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 26, 1, 1532, 2140)
85145034
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:17<00:00, 17.70s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:17<00:00, 17.70s/it]
DECON SHAPE  (1, 26, 1, 1532, 2140)
/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_Mdivi1_18h_6/240119_RPE1_Torin_Mdivi1_18h_6_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 26, 1, 1532, 2140)
85145034
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:17<00:00, 17.69s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:17<00:00, 17.69s/it]
DECON SHAPE  (1, 26, 1, 1532, 2140)
/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_1/240119_RPE1_Torin_MFI8_18h_1_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.86s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:23<00:23, 23.85s/it]
  0%|          | 0/1 [00:23<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_10/240119_RPE1_Torin_MFI8_18h_10_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.91s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.21s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_11/240119_RPE1_Torin_MFI8_18h_11_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:15<00:15, 15.18s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.10s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_12/240119_RPE1_Torin_MFI8_18h_12_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.95s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.45s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_13/240119_RPE1_Torin_MFI8_18h_13_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.95s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:23<00:23, 23.97s/it]
  0%|          | 0/1 [00:23<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_14/240119_RPE1_Torin_MFI8_18h_14_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.93s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.49s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_15/240119_RPE1_Torin_MFI8_18h_15_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:15<00:15, 15.15s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.14s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_16/240119_RPE1_Torin_MFI8_18h_16_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.99s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.59s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_17/240119_RPE1_Torin_MFI8_18h_17_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:14<00:14, 14.95s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.03s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_2/240119_RPE1_Torin_MFI8_18h_2_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:15<00:15, 15.35s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.75s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_4/240119_RPE1_Torin_MFI8_18h_4_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:15<00:15, 15.24s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.47s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_6/240119_RPE1_Torin_MFI8_18h_6_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:15<00:15, 15.51s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:25<00:25, 25.67s/it]
  0%|          | 0/1 [00:25<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_7/240119_RPE1_Torin_MFI8_18h_7_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:15<00:15, 15.45s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:24<00:24, 24.73s/it]
  0%|          | 0/1 [00:24<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

/nfs/nas22/fs2202/biol_bc_kleele_2/Joshua/240119_RPE1_Torin_Mdivi_MFI8_iSIM/18h/240119_RPE1_Torin_MFI8_18h_8/240119_RPE1_Torin_MFI8_18h_8_MMStack_Default.ome.tif
header 4 : b'<?xm'
header[:2]:  b'l '
SHAPE (1, 31, 1, 1532, 2140)
101519079
n_stacks  2.0
n_slices  15
z  31
[(0, 21), (15, 31)]
No destripe specified.
3D images, sigma:  [2.4, 1.6702355460385439, 1.6702355460385439]
  0%|          | 0/1 [00:00<?, ?it/s]
  0%|          | 0/2 [00:00<?, ?it/s][A
 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:15<00:15, 15.49s/it][A 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:25<00:25, 25.62s/it]
  0%|          | 0/1 [00:25<?, ?it/s]
17  and  16
0
Traceback (most recent call last):
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1378, in _do_call
    return fn(*args)
           ^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1361, in _run_fn
    return self._call_tf_sessionrun(options, feed_dict, fetch_list,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1454, in _call_tf_sessionrun
    return tf_session.TF_SessionRun_wrapper(self._session, options, feed_dict,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 242, in decon_ome_stack
    decon[timepoint, slices[0]+OVERLAP//2:slices[1], channel, :, :] = richardson_lucy(data_here, params=params)[OVERLAP//2:, :, :]
                                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 98, in richardson_lucy
    res = algo.run(fd_data.Acquisition(data=image, kernel=kernel['kernel']), niter=10).data
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 216, in run
    res = self._run(acquisition, input_kwargs, session_config=session_config)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 83, in _run
    res = sess.run(self.graph.outputs, feed_dict={**data_dict, **args_dict})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 968, in run
    result = self._run(None, fetches, feed_dict, options_ptr,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1191, in _run
    results = self._do_run(handle, final_targets, final_fetches,
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1371, in _do_run
    return self._do_call(_run_fn, feeds, fetches, targets, options,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/client/session.py", line 1397, in _do_call
    raise type(e)(node_def, op, message)  # pylint: disable=no-value-for-parameter
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
Detected at node 'Pad' defined at (most recent call last):
    File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
      cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
      params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
    File "<string>", line 11, in __init__
    File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
      self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
      self.graph = self._get_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
      inputs, outputs = self._build_tf_graph()
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
      kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
    File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
      return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
Node: 'Pad'
2 root error(s) found.
  (0) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
	 [[result/_131]]
  (1) INVALID_ARGUMENT: Paddings must be non-negative: 0 -1
	 [[{{node Pad}}]]
0 successful operations.
0 derived errors ignored.

Original stack trace for 'Pad':
  File "/cluster/home/jsammet/iSIM/deconvolution/script_folder.py", line 35, in <module>
    cuda_decon.decon_ome_stack(file.as_posix(), params=parameters)
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 210, in decon_ome_stack
    params = CudaParams(background=background, shape=kernel_shape, ndim=ndim, z_step=z_step, destripe=destripe_zones)
  File "<string>", line 11, in __init__
  File "/cluster/home/jsammet/iSIM/deconvolution/cuda_decon.py", line 67, in __post_init__
    self.algo = fd_restoration.RichardsonLucyDeconvolver(self.ndim, start_mode="INPUT").initialize()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 62, in initialize
    self.graph = self._get_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 58, in _get_tf_graph
    inputs, outputs = self._build_tf_graph()
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/restoration.py", line 264, in _build_tf_graph
    kernt = tf.cast(ifftshift(pad_around_center(kernh, tf.shape(datat))), self.fft_dtype)
  File "/cluster/home/jsammet/.local/lib64/python3.11/site-packages/flowdec/tf_ops.py", line 52, in pad_around_center
    return tf.pad(t, tf.stack([lopad, hipad], axis=1), mode=mode, constant_values=constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3586, in pad_v2
    return pad(tensor, paddings, mode, name, constant_values)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/traceback_utils.py", line 150, in error_handler
    return fn(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/util/dispatch.py", line 1176, in op_dispatch_handler
    return dispatch_target(*args, **kwargs)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/array_ops.py", line 3655, in pad
    result = gen_array_ops.pad(tensor, paddings, name=name)
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/ops/gen_array_ops.py", line 6681, in pad
    _, _, _op, _outputs = _op_def_library._apply_op_helper(
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/op_def_library.py", line 795, in _apply_op_helper
    op = g._create_op_internal(op_type_name, inputs, dtypes=None,
  File "/cluster/apps/nss/gcc-8.2.0/python/3.11.2/x86_64/lib64/python3.11/site-packages/tensorflow/python/framework/ops.py", line 3814, in _create_op_internal
    ret = Operation(

